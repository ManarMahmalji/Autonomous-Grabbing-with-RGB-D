% ############################################################
% ## BRUFACE: Brussels Faculty of Engineering 
% ############################################################
% ## Master Thesis " Autonmous Grabbing with RGB-D"  
% ## July 2022 Manar Mahmalji      
% ## Version (1)     
% ############################################################
% ##This code is used to obtain the gripper poses at differtent joint angles 
% ##wrt the robot base frame using the robot's direct kinematics 

N=25; % Number of samples 
q=zeros(N,7);  % Joint angles 
q(1,:)= [-58.99 -7.93 -11.91 82.13 -47.15 -16.21 55.2];
q(2,:)= [-58.99 -7.93 -11.91 82.12 -47.15 -16.21 84.64];
q(3,:)= [-58.99 -7.93 -11.91 82.12 -47.15 -25.67 33.32];
q(4,:)= [-58.99 -7.93 -11.91 82.12 -47.15 -23.31 95.45];
q(5,:)= [-58.99 -7.93 -11.91 82.12 -47.15 -35.25 95.45];
q(6,:)= [-58.99 -7.93 -11.91 82.12 45.05 -17.04 52.71];
q(7,:)= [-48.65 7.43 -11.92 97.23 -40.64 -6.61 175];
q(8,:)= [-48.65 7.43 -11.92 97.23 -40.64 -6.61 62.84];
q(9,:)= [-48.65 7.43 -11.92 97.23 -40.64 -34.47 62.84];
q(10,:)= [-48.65 4.16 -28.48 97.23 -40.64 -4.73 62.84];
q(11,:)= [-48.65 4.15 -11.88 97.23 -40.64 -4.72 20.73];
q(12,:)= [-71.14 4.15 -11.89 97.23 -40.64 -4.72 20.73];
q(13,:)= [-35.2 -18.67 -11.88 71.87 -75.8 -39.96 62.76];
q(14,:)= [-35.2 -18.66 -11.88 71.87 -75.8 -39.96 36.57];
q(15,:)= [-35.2 -18.66 -11.88 71.87 -75.8 -39.96 -14];
q(16,:)= [-35.2 -18.66 -11.88 71.87 -75.8 -39.96 -74.85];
q(17,:)= [-35.64 -20.71 -11.88 78.72 -127.29 -50.83 -42.44];
q(18,:)= [-35.64 -20.71 -11.88 78.72 -127.29 -69.31 -42.44];
q(19,:)= [-35.64 -20.71 -11.88 78.72 -90.71 -31.50 -42.44];
q(20,:)= [-35.64 -17.21 -31.3 78.72 -90.71 -31.50 -42.44];
q(21,:)= [-35.64 -17.2 -31.3 78.72 -90.71 -31.50 -153.95];
q(22,:)= [-35.64 -17.2 -31.3 78.72 -90.71 -31.50 -77.64];
q(23,:)= [-20.51 -2.32 -31.30 94.17 -97.53 -46.11 -77.13];
q(24,:)= [-20.51 -2.32 -31.30 94.16 -97.54 -17.59 -77.12];
q(25,:)= [-20.51 -2.32 -31.30 94.16 -97.54 -76.63 -77.12];
% 
% for each joint angles vector, get the pose of the gripper wrt the 
% robot base frame then save it in an excel sheet
for i=1:N
T=T_kuka(q(i,:)*pi/180); % robot's kinematics
T=[0 1 2 3; T];
sheetName="Sheet1"+num2str(i);
if i==1
    writematrix(T,"gripper2base.xlsx",'Sheet',sheetName,'WriteMode', 'replacefile' );
else 
    writematrix(T,"gripper2base.xlsx",'Sheet',sheetName,'WriteMode', 'overwritesheet' );
end
end